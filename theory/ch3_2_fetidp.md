# FETI-DP Introduction
FETI-DP (Dual-Primal FETI) is a DDM DDM method introduced by Farhat et al. (2003), as a simpler and in many cases more efficient, alternative to FETI-1. FETI-DP is based on a dual-primary formulation of the problem to be solved. The main difference between the FETI-DP method and FETI-1 is that in FETI-DP, in every iteration of the PCG method, the compatibility of displacements is imposed to a small subset of primal **corner** DOFs, while the compatibility of displacements of the remaining boundary DOFs is only achieved after convergence.  

Before continuing to the theory presented next, it is recommended to read the chapters on [general DDMs](ch3_ddm_solvers.md) and [FETI-1](ch3_1_feti1.md). For a more detailed description of FETI-DP, see [the original publication](https://www.researchgate.net/publication/51992274_A_scalable_dual-primal_domain_decomposition_method).

# FETI-DP Theory

## Primal & dual DOFs
<img src="img/corner_nodes.svg" alt="Lagrange corner_nodes" width="300"/>

For a given mesh partition, we define its corners as the set of nodes located at the beginning and end of each edge of each subdomain, as illustrated in the figure above. Using this definition in 2D problems, the set of corner nodes will include all crosspoints, namely nodes belonging to more than two subdomains.

The freedom degrees (DOFs) associated with these corner nodes will be called **corner** or **primal** DOFs and designated with the subscript *c*. The other DOFs of each subdomain will be called **remainder** DOFs and designated the subscript *r*. E.g. if we denote by **K**<sup>s</sup>, **u**<sup>s</sup> and**f**<sup>s</sup> the stiffness matrix, displacement vector and force vector of vector of subdomain *s* respectively, these quantities are then decomposed based on the DOFs:

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{u}^s&space;=&space;\begin{bmatrix}&space;\mathbf{u}^s_c&space;\\&space;\mathbf{u}^s_r\end{bmatrix}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{u}^s&space;=&space;\begin{bmatrix}&space;\mathbf{u}^s_c&space;\\&space;\mathbf{u}^s_r\end{bmatrix}" title="\mathbf{u}^s = \begin{bmatrix} \mathbf{u}^s_c \\ \mathbf{u}^s_r\end{bmatrix}" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{K}^s&space;=&space;\begin{bmatrix}&space;\mathbf{K}^s_{cc}&space;&&space;\mathbf{K}^s_{cr}\\&space;\left(&space;\mathbf{K}^s_{cr}&space;\right)^T&space;&&space;\mathbf{K}^s_{rr}&space;\end{bmatrix}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{K}^s&space;=&space;\begin{bmatrix}&space;\mathbf{K}^s_{cc}&space;&&space;\mathbf{K}^s_{cr}\\&space;\left(&space;\mathbf{K}^s_{cr}&space;\right)^T&space;&&space;\mathbf{K}^s_{rr}&space;\end{bmatrix}" title="\mathbf{K}^s = \begin{bmatrix} \mathbf{K}^s_{cc} & \mathbf{K}^s_{cr}\\ \left( \mathbf{K}^s_{cr} \right)^T & \mathbf{K}^s_{rr} \end{bmatrix}" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{f}^s&space;=&space;\begin{bmatrix}&space;\mathbf{f}^s_c&space;\\&space;\mathbf{f}^s_r\end{bmatrix}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{f}^s&space;=&space;\begin{bmatrix}&space;\mathbf{f}^s_c&space;\\&space;\mathbf{f}^s_r\end{bmatrix}" title="\mathbf{f}^s = \begin{bmatrix} \mathbf{f}^s_c \\ \mathbf{f}^s_r\end{bmatrix}" /></a>

We further decompose remainder DOFs into **internal** DOFs, which are associated with nodes that belong to only one subdomain and are designated by the subscript *i*, and **boundary-remainder** DOFs, which are associated with nodes that belong to more than one subdomains without being corners and are designated by the subscript *b*. E.g.

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{u}^s_r&space;=&space;\begin{bmatrix}&space;\mathbf{u}^s_b&space;\\&space;\mathbf{u}^s_i\end{bmatrix}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{u}^s_r&space;=&space;\begin{bmatrix}&space;\mathbf{u}^s_b&space;\\&space;\mathbf{u}^s_i\end{bmatrix}" title="\mathbf{u}^s_r = \begin{bmatrix} \mathbf{u}^s_b \\ \mathbf{u}^s_i\end{bmatrix}" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{K}^s_{rr}&space;=&space;\begin{bmatrix}&space;\mathbf{K}^s_{bb}&space;&&space;\mathbf{K}^s_{bi}\\&space;\left(&space;\mathbf{K}^s_{bi}&space;\right)^T&space;&&space;\mathbf{K}^s_{ii}&space;\end{bmatrix}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{K}^s_{rr}&space;=&space;\begin{bmatrix}&space;\mathbf{K}^s_{bb}&space;&&space;\mathbf{K}^s_{bi}\\&space;\left(&space;\mathbf{K}^s_{bi}&space;\right)^T&space;&&space;\mathbf{K}^s_{ii}&space;\end{bmatrix}" title="\mathbf{K}^s_{rr} = \begin{bmatrix} \mathbf{K}^s_{bb} & \mathbf{K}^s_{bi}\\ \left( \mathbf{K}^s_{bi} \right)^T & \mathbf{K}^s_{ii} \end{bmatrix}" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{f}^s_r&space;=&space;\begin{bmatrix}&space;\mathbf{f}^s_b&space;\\&space;\mathbf{f}^s_i\end{bmatrix}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{f}^s_r&space;=&space;\begin{bmatrix}&space;\mathbf{f}^s_b&space;\\&space;\mathbf{f}^s_i\end{bmatrix}" title="\mathbf{f}^s_r = \begin{bmatrix} \mathbf{f}^s_b \\ \mathbf{f}^s_i\end{bmatrix}" /></a>

We gather the displacements corresponding to all corner dofs of the whole domain in a vector $u_c$ of length *N_c* and define the mapping between global <a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{\bar{u}}_c" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{\bar{u}}_c" title="\mathbf{\bar{u}}_c" /></a> and subdomain <a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{u}^s_c" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{u}^s_c" title="\mathbf{u}^s_c" /></a> as boolean matrices <a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{B}^s_c" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{B}^s_c" title="\mathbf{B}^s_c" /></a> that have 0/1 entries and dimensions <a href="https://www.codecogs.com/eqnedit.php?latex=\left(N_c^s&space;\times&space;N_c&space;\right)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\left(N_c^s&space;\times&space;N_c&space;\right)" title="\left(N_c^s \times N_c \right)" /></a>, where <a href="https://www.codecogs.com/eqnedit.php?latex=N_c^s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?N_c^s" title="N_c^s" /></a> and <a href="https://www.codecogs.com/eqnedit.php?latex=N_c" target="_blank"><img src="https://latex.codecogs.com/gif.latex?N_c" title="N_c" /></a> are the number of corner DOFs of subdomain *s* and the whole domain, respectively.

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{B}_c^s&space;\mathbf{u}_c&space;=&space;\mathbf{u}_c^s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{B}_c^s&space;\mathbf{u}_c&space;=&space;\mathbf{u}_c^s" title="\mathbf{B}_c^s \mathbf{u}_c = \mathbf{u}_c^s" /></a>


As in FETI-1, the continuity between the otherwise diconnected subdomains is retained by enforcing equal displacements for instances of the same boundary DOF in different subdomains. E.g. if subdomains *s=1,2* share the same boundary dof *k*:

<a href="https://www.codecogs.com/eqnedit.php?latex=\begin{bmatrix}&space;1&space;&&space;-1&space;\end{bmatrix}&space;\cdot&space;\begin{bmatrix}&space;u_k^{(1)}&space;\\&space;u_k^{(2)}&space;\end{bmatrix}&space;=&space;0" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\begin{bmatrix}&space;1&space;&&space;-1&space;\end{bmatrix}&space;\cdot&space;\begin{bmatrix}&space;u_k^{(1)}&space;\\&space;u_k^{(2)}&space;\end{bmatrix}&space;=&space;0" title="\begin{bmatrix} 1 & -1 \end{bmatrix} \cdot \begin{bmatrix} u_k^{(1)} \\ u_k^{(2)} \end{bmatrix} = 0" /></a>

These continuity equations are gathered into signed boolean matrices <a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{B}_r^{s}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{B}_r^{s}" title="\mathbf{B}_r^{s}" /></a> which have 0, 1, -1 entries and dimensions <a href="https://www.codecogs.com/eqnedit.php?latex=\left(N_{\lambda}&space;\times&space;N_r^s&space;\right)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\left(N_{\lambda}&space;\times&space;N_r^s&space;\right)" title="\left(N_{\lambda} \times N_r^s \right)" /></a>, where <a href="https://www.codecogs.com/eqnedit.php?latex=N_{\lambda}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?N_{\lambda}" title="N_{\lambda}" /></a> is the number of continuity equations of the whole domain and <a href="https://www.codecogs.com/eqnedit.php?latex=N_r^s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?N_r^s" title="N_r^s" /></a> the number of subdomain's *s* remainder dofs:

<a href="https://www.codecogs.com/eqnedit.php?latex=\sum_{s&space;=&space;1}^{N_{s}}&space;\mathbf{B}_r^{s}&space;\mathbf{u}_r^{s}&space;=&space;\mathbf{0}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\sum_{s&space;=&space;1}^{N_{s}}&space;\mathbf{B}_r^{s}&space;\mathbf{u}_r^{s}&space;=&space;\mathbf{0}" title="\sum_{s = 1}^{N_{s}} \mathbf{B}_r^{s} \mathbf{u}_r^{s} = \mathbf{0}" /></a>

<img src="img/langrange_multipliers.svg" alt="Lagrange multipliers" width="500"/>

To solve the initial equilibrium equations **K u = f** in the presence of these constraints, we apply Lagrange multipliers **λ** at boundary DOFs, as illustrated in the figure above. These are dual quantities and can be viewed as forces, while displacements are primal quantities. It should be clarified that no Lagrange multipliers are applied at corner dofs. The equilibrium equations can then be written as:

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{K}_{rr}^s&space;u_r^s&space;&plus;&space;\mathbf{K}_{rc}^s&space;\mathbf{B}_c^s&space;\mathbf{u}_c&space;&plus;&space;(\mathbf{B}_r^s)^T&space;\mathbf{\lambda}&space;=&space;\mathbf{f}_r^s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{K}_{rr}^s&space;u_r^s&space;&plus;&space;\mathbf{K}_{rc}^s&space;\mathbf{B}_c^s&space;\mathbf{u}_c&space;&plus;&space;(\mathbf{B}_r^s)^T&space;\mathbf{\lambda}&space;=&space;\mathbf{f}_r^s" title="\mathbf{K}_{rr}^s u_r^s + \mathbf{K}_{rc}^s \mathbf{B}_c^s \mathbf{u}_c + (\mathbf{B}_r^s)^T \mathbf{\lambda} = \mathbf{f}_r^s" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=\sum_{s&space;=&space;1}^{N_{s}}&space;(\mathbf{B}_c^s)^T&space;(\mathbf{K}_{rc}^s)^T&space;\mathbf{u}_r^s&space;&plus;&space;\sum_{s&space;=&space;1}^{N_{s}}&space;(\mathbf{B}_c^s)^T&space;(\mathbf{K}_{cc}^s)^T&space;\mathbf{B}_c^s&space;\mathbf{u}_c^s&space;=&space;\sum_{s&space;=&space;1}^{N_{s}}&space;(\mathbf{B}_c^s)^T&space;\mathbf{f}_c^s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\sum_{s&space;=&space;1}^{N_{s}}&space;(\mathbf{B}_c^s)^T&space;(\mathbf{K}_{rc}^s)^T&space;\mathbf{u}_r^s&space;&plus;&space;\sum_{s&space;=&space;1}^{N_{s}}&space;(\mathbf{B}_c^s)^T&space;(\mathbf{K}_{cc}^s)^T&space;\mathbf{B}_c^s&space;\mathbf{u}_c^s&space;=&space;\sum_{s&space;=&space;1}^{N_{s}}&space;(\mathbf{B}_c^s)^T&space;\mathbf{f}_c^s" title="\sum_{s = 1}^{N_{s}} (\mathbf{B}_c^s)^T (\mathbf{K}_{rc}^s)^T \mathbf{u}_r^s + \sum_{s = 1}^{N_{s}} (\mathbf{B}_c^s)^T (\mathbf{K}_{cc}^s)^T \mathbf{B}_c^s \mathbf{u}_c^s = \sum_{s = 1}^{N_{s}} (\mathbf{B}_c^s)^T \mathbf{f}_c^s" /></a>

## Interface problem

With an appropriate selection of corner nodes <a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{K}_{rr}^s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{K}_{rr}^s" title="\mathbf{K}_{rr}^s" /></a> is an invertible matrix, meaning that the floating subdomains of the original FETI method are avoided in FETI-DP. We can then consider each subdomain as a superelement that has the subdomain's corners as nodes. The stiffness and applied forces of this superelement are obtained by perform static condensation of the remainder DOFs. Then we assemble the resulting matrices/vectors into global ones, exactly as we would do with individual elements in FEM.

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{K}_{cc}^{*}&space;=&space;\sum_{s&space;=&space;1}^{N_{s}}&space;(\mathbf{B}_{c}^{s})^{T}&space;\left(&space;\mathbf{K}_{cc}^s-(\mathbf{K}_{rc}^{s})^{T}(\mathbf{K}_{rr}^{s})^{-1}&space;\mathbf{K}_{rc}^{s}&space;\right)&space;\mathbf{B}_{c}^{s}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{K}_{cc}^{*}&space;=&space;\sum_{s&space;=&space;1}^{N_{s}}&space;(\mathbf{B}_{c}^{s})^{T}&space;\left(&space;\mathbf{K}_{cc}^s-(\mathbf{K}_{rc}^{s})^{T}(\mathbf{K}_{rr}^{s})^{-1}&space;\mathbf{K}_{rc}^{s}&space;\right)&space;\mathbf{B}_{c}^{s}" title="\mathbf{K}_{cc}^{*} = \sum_{s = 1}^{N_{s}} (\mathbf{B}_{c}^{s})^{T} \left( \mathbf{K}_{cc}^s-(\mathbf{K}_{rc}^{s})^{T}(\mathbf{K}_{rr}^{s})^{-1} \mathbf{K}_{rc}^{s} \right) \mathbf{B}_{c}^{s}" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{f}_{c}^{*}&space;=&space;\sum_{s&space;=&space;1}^{N_{s}}&space;(\mathbf{B}_{c}^{s})^{T}&space;\left(&space;\mathbf{f}_{c}^s&space;-&space;(\mathbf{K}_{rc}^{s})^{T}(\mathbf{K}_{rr}^{s})^{-1}\mathbf{f}_{r}^{s}&space;\right)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{f}_{c}^{*}&space;=&space;\sum_{s&space;=&space;1}^{N_{s}}&space;(\mathbf{B}_{c}^{s})^{T}&space;\left(&space;\mathbf{f}_{c}^s&space;-&space;(\mathbf{K}_{rc}^{s})^{T}(\mathbf{K}_{rr}^{s})^{-1}\mathbf{f}_{r}^{s}&space;\right)" title="\mathbf{f}_{c}^{*} = \sum_{s = 1}^{N_{s}} (\mathbf{B}_{c}^{s})^{T} \left( \mathbf{f}_{c}^s - (\mathbf{K}_{rc}^{s})^{T}(\mathbf{K}_{rr}^{s})^{-1}\mathbf{f}_{r}^{s} \right)" /></a>

Since <a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{K}_{rr}^s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{K}_{rr}^s" title="\mathbf{K}_{rr}^s" /></a> is positive definite, its Schur complement is also positive definite. Assembling these Schur complements into $\bm{K}_{cc}^*$ also results in a positive definite matrix. We also set the following quantities:

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{F}_{Irr}&space;=&space;\sum_{s&space;=&space;1}^{N_{s}}\mathbf{B}_{r}^{s}(\mathbf{K}_{rr}^{s})^{-1}(\mathbf{B}_{r}^{s})^{T}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{F}_{Irr}&space;=&space;\sum_{s&space;=&space;1}^{N_{s}}\mathbf{B}_{r}^{s}(\mathbf{K}_{rr}^{s})^{-1}(\mathbf{B}_{r}^{s})^{T}" title="\mathbf{F}_{Irr} = \sum_{s = 1}^{N_{s}}\mathbf{B}_{r}^{s}(\mathbf{K}_{rr}^{s})^{-1}(\mathbf{B}_{r}^{s})^{T}" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{F}_{Irc}&space;=&space;\sum_{s&space;=&space;1}^{N_{s}}\mathbf{B}_{r}^{s}(\mathbf{K}_{rr}^{s})^{-1}\mathbf{K}_{rc}^{s}\mathbf{B}_{c}^{s}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{F}_{Irc}&space;=&space;\sum_{s&space;=&space;1}^{N_{s}}\mathbf{B}_{r}^{s}(\mathbf{K}_{rr}^{s})^{-1}\mathbf{K}_{rc}^{s}\mathbf{B}_{c}^{s}" title="\mathbf{F}_{Irc} = \sum_{s = 1}^{N_{s}}\mathbf{B}_{r}^{s}(\mathbf{K}_{rr}^{s})^{-1}\mathbf{K}_{rc}^{s}\mathbf{B}_{c}^{s}" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{d}_{r}&space;=&space;\sum_{s&space;=&space;1}^{N_{s}}\mathbf{B}_{r}^{s}(\mathbf{K}_{rr}^{s})^{-1}\mathbf{f}_{r}^{s}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{d}_{r}&space;=&space;\sum_{s&space;=&space;1}^{N_{s}}\mathbf{B}_{r}^{s}(\mathbf{K}_{rr}^{s})^{-1}\mathbf{f}_{r}^{s}" title="\mathbf{d}_{r} = \sum_{s = 1}^{N_{s}}\mathbf{B}_{r}^{s}(\mathbf{K}_{rr}^{s})^{-1}\mathbf{f}_{r}^{s}" /></a>

Note that <a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{F}_{Irr}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{F}_{Irr}" title="\mathbf{F}_{Irr}" /></a> is essentially the inverse of the original stiffness matrix of the whole domain, limited to boundary DOFs, hence a flexibility matrix. Furthermore <a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{d}_{r}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{d}_{r}" title="\mathbf{d}_{r}" /></a> expresses the displacements, due to loading, along boundary dofs of the subdomains, as if they were not connected to each other. 

After some algebraic manipulation the equilibrium equation can be written as:

<a href="https://www.codecogs.com/eqnedit.php?latex=\begin{bmatrix}&space;\mathbf{F}_{Irr}&space;&&space;\mathbf{F}_{Irc}&space;\\&space;\left(\mathbf{F}_{Irc}\right)^T&space;&&space;-\mathbf{K}_{cc}^*&space;\end{bmatrix}&space;\cdot&space;\begin{bmatrix}&space;\mathbf{\lambda}&space;\\&space;\mathbf{u}_c&space;\end{bmatrix}&space;=&space;\begin{bmatrix}&space;\mathbf{d}_r&space;\\&space;-\mathbf{f}_c^s&space;\end{bmatrix}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\begin{bmatrix}&space;\mathbf{F}_{Irr}&space;&&space;\mathbf{F}_{Irc}&space;\\&space;\left(\mathbf{F}_{Irc}\right)^T&space;&&space;-\mathbf{K}_{cc}^*&space;\end{bmatrix}&space;\cdot&space;\begin{bmatrix}&space;\mathbf{\lambda}&space;\\&space;\mathbf{u}_c&space;\end{bmatrix}&space;=&space;\begin{bmatrix}&space;\mathbf{d}_r&space;\\&space;-\mathbf{f}_c^s&space;\end{bmatrix}" title="\begin{bmatrix} \mathbf{F}_{Irr} & \mathbf{F}_{Irc} \\ \left(\mathbf{F}_{Irc}\right)^T & -\mathbf{K}_{cc}^* \end{bmatrix} \cdot \begin{bmatrix} \mathbf{\lambda} \\ \mathbf{u}_c \end{bmatrix} = \begin{bmatrix} \mathbf{d}_r \\ -\mathbf{f}_c^s \end{bmatrix}" /></a>

By decoupling the corner DOFs from the Lagrange multipliers, the linear system of the FETI-DP interface problem is obtained:

<a href="https://www.codecogs.com/eqnedit.php?latex=\left(&space;\mathbf{F}_{Irr}&space;&plus;&space;\mathbf{F}_{Irc}&space;(\mathbf{K}_{cc}^*)^{-1}&space;(\mathbf{F}_{Irc})^T&space;\right)&space;\cdot&space;\mathbf{\lambda}&space;=&space;\mathbf{d}_r&space;-&space;\mathbf{F}_{Irc}&space;(\mathbf{K}_{cc})^{-1}&space;\mathbf{f}_c^*" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\left(&space;\mathbf{F}_{Irr}&space;&plus;&space;\mathbf{F}_{Irc}&space;(\mathbf{K}_{cc}^*)^{-1}&space;(\mathbf{F}_{Irc})^T&space;\right)&space;\cdot&space;\mathbf{\lambda}&space;=&space;\mathbf{d}_r&space;-&space;\mathbf{F}_{Irc}&space;(\mathbf{K}_{cc})^{-1}&space;\mathbf{f}_c^*" title="\left( \mathbf{F}_{Irr} + \mathbf{F}_{Irc} (\mathbf{K}_{cc}^*)^{-1} (\mathbf{F}_{Irc})^T \right) \cdot \mathbf{\lambda} = \mathbf{d}_r - \mathbf{F}_{Irc} (\mathbf{K}_{cc})^{-1} \mathbf{f}_c^*" /></a>

The matrix of the linear system above is positive definite, therefore the interface problem can be solved using the Preconditioned Conjugate Gradient method (PCG). After solving it for the Lagrange multipliers **λ**, the displacements at corner and remainder DOFs can be calculated by

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{u}_{c}&space;=&space;\left(&space;\mathbf{K}_{cc}^*&space;\right)^{-1}&space;\left(&space;\mathbf{f}_{c}^{*}&space;&plus;&space;(\mathbf{F}_{Irc})^T&space;\mathbf{\lambda}&space;\right)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{u}_{c}&space;=&space;\left(&space;\mathbf{K}_{cc}^*&space;\right)^{-1}&space;\left(&space;\mathbf{f}_{c}^{*}&space;&plus;&space;(\mathbf{F}_{Irc})^T&space;\mathbf{\lambda}&space;\right)" title="\mathbf{u}_{c} = \left( \mathbf{K}_{cc}^* \right)^{-1} \left( \mathbf{f}_{c}^{*} + (\mathbf{F}_{Irc})^T \mathbf{\lambda} \right)" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{u}_{r}^{s}&space;=(\mathbf{K}_{rr}^s)^{-1}(\mathbf{f}_r^s&space;-&space;\left(\mathbf{B}_r^s)^T&space;\mathbf{\lambda}&space;-&space;\mathbf{K}_{rc}^s&space;\mathbf{B}_c^s&space;\mathbf{u}_c&space;\right)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{u}_{r}^{s}&space;=(\mathbf{K}_{rr}^s)^{-1}(\mathbf{f}_r^s&space;-&space;\left(\mathbf{B}_r^s)^T&space;\mathbf{\lambda}&space;-&space;\mathbf{K}_{rc}^s&space;\mathbf{B}_c^s&space;\mathbf{u}_c&space;\right)" title="\mathbf{u}_{r}^{s} =(\mathbf{K}_{rr}^s)^{-1}(\mathbf{f}_r^s - \left(\mathbf{B}_r^s)^T \mathbf{\lambda} - \mathbf{K}_{rc}^s \mathbf{B}_c^s \mathbf{u}_c \right)" /></a>

## Coarse problem
During the solution of the interface problem, at each matrix-vector multiplication:  

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{F}_{Irr}&space;&plus;&space;\mathbf{F}_{Irc}&space;(\mathbf{K}_{cc}^*)^{-1}&space;(\mathbf{F}_{Irc})^{T}$" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{F}_{Irr}&space;&plus;&space;\mathbf{F}_{Irc}&space;(\mathbf{K}_{cc}^*)^{-1}&space;(\mathbf{F}_{Irc})^{T}$" title="\mathbf{F}_{Irr} + \mathbf{F}_{Irc} (\mathbf{K}_{cc}^*)^{-1} (\mathbf{F}_{Irc})^{T}$" /></a>

performed in PCG, we need to solve the linear system 

<a href="https://www.codecogs.com/eqnedit.php?latex=\mathbf{K}_{cc}^*&space;\cdot&space;$\mathbf{x}&space;=&space;$\mathbf{y}$" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\mathbf{K}_{cc}^*&space;\cdot&space;$\mathbf{x}&space;=&space;$\mathbf{y}$" title="\mathbf{K}_{cc}^* \cdot $\mathbf{x} = $\mathbf{y}$" /></a>. 

This linear system expresses the coarse problem of FETI-DP: a much smaller auxilliary problem involving only corner DOFs, that speeds up convergence by coupling the subdomain computations and globally propagating the error at each PCG iteration.

## Preconditioning
FETI-DP uses the same preconditioners as FETI-1 to speed up the convergence of PCG when solving the interface problem. The only difference is that boundary corner DOFs are not taken into account in the preconditiones, since in FETI-DP they are not part of the interface problem. Therefore all matrices with the index *b* refer to the boundary-remainder DOFs, instead of all boundary DOFs. For more details, see [FETI-1 preconditioners](ch3_1_feti1.md##Preconditioning)

# FETI-DP Remarks
FETI-DP is an efficient DDM that exhibits good scalability, namely the iterations required to converge do not increase as the number of subdomains increases. This makes it applicable to large scale simulations run on computing systems with a lot of networked computers. By using a set of primal (corner) DOFs, it avoids the floating subdomains of FETI-1 and all their problems, therefore it is much simpler to comprehend and implement. Furthermore, it is often more efficient than FETI-1.